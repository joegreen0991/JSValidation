var Validator=function(){var e=function(n){var r=function(){return new function(){var e=null,t=[],n=[],r=function(r){for(n=r||n;t.length;)t.shift()[!1===e?1:0].apply(this,n)},i=function(){};this.then=function(n,s){t.push([n||i,s||i]);null!==e&&r();return this};this.resolve=function(){e=!0;r(arguments);return this};this.reject=function(){e=!1;r(arguments);return this}}};r.when=function(e){for(var t=r(),n=0,i=!1,s=0,o=e.length;s<o;s++)e[s].then(function(){e.length===++n&&t.resolve()},function(){i=i||t.reject.apply(t,arguments)||!0});return 0===e.length?t.resolve():deferrred};n=t.extend({attr:"data-validate",ruleSeparator:/\s+/,ruleArgumentSeparator:":",argumentSeparator:",",defaultMessage:"Please check this field for errors",strict:!1},e.plugins,n);var i=function(e,r,i,s){i=i.slice(0);i.push(s);n.validators[r]?n.validators[r].apply(e,i):n.regex[r]?s(n.regex[r].test(e.value)):n.strict?t.error('A validator or regex has not been set for  "'+r+'"'):s(!0);return this};this.input=function(e){var s=[],o=e.getAttribute(n.attr);o&&t.loop(o.replace(/^\s+|\s+$/g,"").split(n.ruleSeparator),function(t){s[t]=r();var o=this.split(n.ruleArgumentSeparator),u=o[1]?o[1].split(n.argumentSeparator):[];i(e,o[0],u,function(e){e?s[t].resolve():s[t].reject(o[0],u)})});return r.when(s)};this.form=function(e,i,s){var o=[],u=this;t.loop(t.getElements("input,select,checkbox,textarea",e),function(){var e=this;o.push(u.input(e).then(function(r,s){i&&i(e,t.tmpl((n.messages[r]?n.messages[r]:n.defaultMessage).replace("{value}",e.value),s),r,s)},function(r,i){s&&s(e,t.tmpl((n.messages[r]?n.messages[r]:n.defaultMessage).replace("{value}",e.value),i),r,i)}))});return r.when(o)}},t={loop:function(e,t){for(var n=0;n<e.length;n++)t.call(e[n],n)},only:function(e,t){var n={},r;for(r in t)e[t[r]]&&(n[t[r]]=e[t[r]]);return n},tmpl:function(e,t){for(var n in t)e=e.replace("{"+n+"}",t[n]);return e},extend:function(){for(var e=function(t,n){for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];t.hasOwnProperty(r)&&"object"===typeof t[r]&&"object"===typeof i?e(t[r],i):t[r]=i}return t},t={},n=0;n<arguments.length;n++)t=e(t,arguments[n]);return t},error:function(e){throw Error(e)},getElements:function(e,t){t=t||document;for(var n=e.split(","),r=[],i=0;i<n.length;i++)for(var s=t.getElementsByTagName(n[i]),o=0;o<s.length;o++)r.push(s[o]);n=r[0];if(!n)return[];n.sourceIndex?r.sort(function(e,t){return e.sourceIndex-t.sourceIndex}):n.compareDocumentPosition&&r.sort(function(e,t){return 3-(e.compareDocumentPosition(t)&6)});return r}};e.plugin=function(n){t.extend(e.plugins,t.only(n,["messages","regex","validators"]))};e.plugins={messages:{email:"Please enter a valid email address",url:"Please enter a valid URL",alpha:"Please enter only alphabetic characters",alnum:"Please enter only alphabetic characters",alnumextended:"Please enter only A-Z 0-9 _ - characters",integer:"Please enter only whole integers",number:"Please enter a number",positive:"Please enter a positive number",negative:"Please enter a negative number",telephone:"Please enter a valid telephone number",required:"Please fill out this field",length:"Please ensure the value is exactly {0} characters in length",minlength:"Please ensure the value is greater than {0} characters in length",maxlength:"Please ensure the value is less than {0} characters in length",empty:"Please do not fill out this field",min:"Please enter a number greater than or equal to {0}",max:"Please enter a number less than or equal to {0}",checked:"Please check the box to continue"},regex:{email:/^([a-zA-Z0-9_\.\-+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,url:/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,alpha:/^[A-Za-z]+$/,alnum:/^[A-Za-z0-9]+$/,alnumextended:/^[A-Za-z0-9_-]+$/,integer:/^\s*(\+|-)?\d+\s*$/,number:/^\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*$/,telephone:/^(?:\((\+?\d+)?\)|\+?\d+) ?\d*(-?\d{2,3} ?){0,4}$/,required:/^\s*$/,empty:/^$/},validators:{positive:function(t){t(n(this.value)||e.plugins.regex.number.test(this.value)&&0<=this.value)},negative:function(t){t(n(this.value)||e.plugins.regex.number.test(this.value)&&0>=this.value)},min:function(t,r){r(n(this.value)||e.plugins.regex.number.test(this.value)&&this.value>=parseFloat(t))},max:function(t,r){r(n(this.value)||e.plugins.regex.number.test(this.value)&&this.value<=parseFloat(t))},required:function(e){e(!n(this.value))},length:function(e,t){t(n(this.value)||this.value.length==e)},minlength:function(e,t){t(n(this.value)||this.value.length>=e)},maxlength:function(e,t){t(n(this.value)||this.value.length<=e)},checked:function(e){e(this.checked)}}};var n=function(t){return e.plugins.regex.required.test(t)};return e}()
